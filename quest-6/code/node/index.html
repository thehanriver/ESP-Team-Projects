<!DOCTYPE html>
<html>
  <head>
	  <title>Quest 6</title>
  </head>
  <body>
  	<!-- <div id="div1">
      <button id="All"
  			  type="button"
  			  onClick=readAll()
  			  style=" height:50px; width:200px ">
    		All Candidates
    	</button>

    	<button  id="Cands"
          type="button"
  			  onClick=candVotes()
  			  style=" height:50px; width:200px ">
    	   Votes by Candidates
      </button>

      <button id="Clear"
  			  type="button"
  			  onClick=sendClear();
  			  style=" height:50px; width:200px ">
    		Clear Database
    	</button>
    </div> -->
    <div id = 'log'> Log</div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script> window.onload = function () {

      var logContents;
      var updateInterval = 1000;
      function updateLog() {
        $.ajax({url: "/log", success: function(result){
          logContents = "";
          var eventString;

          jQuery.each(result, function(i, val) {
            if (val.event===0){
              eventString = ' denied access';
            }
            else if (val.event===1){
              eventString = ' granted access ';
            }
            else if (val.event===2){
              eventString = ' changed password ';
            }
            console.log('id is ' + val.keyID.toString());
            logContents += "Key " + val.keyID.toString() + eventString + "at time " +val.dateTime + " <br />";

          });

          document.getElementById('log').innerHTML="<b> Log </b><br />" + logContents;
          
          
        }});
      }

      updateLog();
      setInterval(function(){updateLog()}, updateInterval);
    }
    </script>
  </body>
</html>
